@using ArchiveWeb.Models
@model ArchiveWeb.Models.DocRequest
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Akt</title>
    <style type="text/css">
        @@page {
            size: auto; /* auto is the current printer page size */
            margin: 0mm; /* this affects the margin in the printer settings */
        }

        body {
            margin: 0mm;
            font-size: 14pt;
            font-family: Verdana, Arial, sans-serif;
        }

        .sheet {
            width: 1020px !important;
            padding: 10mm;
            padding-left: 20mm;
        }

        .print {
            page-break-after: always;
        }
        table {
            
        }
        table tr td, table tr th {
            padding: 5px;
        }

        table.bordered {border-collapse:collapse; border:1px solid black;} table.bordered tr th, table.bordered tr td {border:1px solid black; padding: 5px;}
    </style>
</head>
<body>
    <div class="print sheet">
        <h3 style="text-align: center">Акт запроса на выдачу документов из архива от @DateTime.Now.ToString("dd.MM.yyyy")</h3>
        <table>
            <tr>
                <th style="text-align: right">№ запроса:</th>
                <td>@Model.Id</td>
            </tr>
            <tr>
                <th style="text-align: right">Дата запроса:</th>
                <td>@Model.DateCreate.ToString("dd.MM.yyyy HH:mm")</td>
            </tr>
            <tr>
                <th style="text-align: right">Автор запроса:</th>
                <td>@Model.CreatorName</td>
            </tr>
            <tr>
                <th style="text-align: right">Количество документов:</th>
                <td>@Model.DocsCount</td>
            </tr>
        </table>
        <p>
            <p>
                Список документов:
            </p>
            @{
                var docs = DocRequest.GetDocumentList(ViewBag.CurUser, Model.Id);

                if (docs.Any())
                {

                    <table class="bordered">
                        <tr><th>ID</th><th>Тип документа</th><th>№ документа</th><th>Дата документа</th><th>Контрагент</th><th>Стеллаж</th><th>Полка</th><th>Папка</th> </tr>
                        @foreach (Document doc in docs)
                        {
                            <tr style="border: 1px solid black"><td>@doc.Id</td><td>@doc.DocType</td><td>@doc.DocNumber</td><td>@doc.DocDate.ToString("dd.MM.yyyy")</td><td>@doc.ContractorName</td><td>@doc.Place.StackNumber</td><td>@doc.Place.ShelfNumber</td><td>@doc.Place.FolderNumber</td></tr>
                        }
                    </table>
                }
            }
        </p>
    </div>
</body>
</html>
